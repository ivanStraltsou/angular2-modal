{"version":3,"file":"modal-backdrop.js","sourceRoot":"","sources":["modal-backdrop.ts"],"names":[],"mappings":";;;;;;;;;;AAAA,qBAUO,eAAe,CAAC,CAAA;AAEvB,sBAA0B,aAAa,CAAC,CAAA;AAGxC,IAAI,cAAc,GAAG,CAAC,CAAC;AAEvB;;GAEG;AAqCH;IAKE,yBAAY,MAAiC;QAL/C,iBAmCC;QAlCC,cAAS,GAAiB,IAAI,CAAC;QAEvB,OAAE,GAAG,EAAC,EAAE,EAAE,IAAI,EAAE,EAAE,EAAE,IAAI,EAAE,EAAE,EAAE,IAAI,EAAC,CAAC;QAG1C,cAAc,EAAE,CAAC;QACjB,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;QAE1C,EAAE,CAAC,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,CAAC;YACrB,IAAI,CAAC,EAAE,CAAC,EAAE,GAAG,UAAU,CAAC;YACxB,IAAI,CAAC,EAAE,CAAC,EAAE,GAAG,MAAM,CAAC;YACpB,IAAI,CAAC,EAAE,CAAC,EAAE,GAAG,GAAG,CAAC;QACnB,CAAC;QAED,MAAM,CAAC,SAAS,CAAC,SAAS,CAAC,cAAM,OAAA,KAAI,CAAC,SAAS,GAAG,KAAK,EAAtB,CAAsB,CAAC,CAAC;IAC3D,CAAC;IAED;;;;;OAKG;IACH,oCAAU,GAAV;QACE,MAAM,CAAC,IAAI,OAAO,CAAO,UAAA,OAAO;YAC9B,UAAU,CAAC,cAAM,OAAA,OAAO,EAAE,EAAT,CAAS,EAAE,GAAG,CAAC,CAAC;QACnC,CAAC,CAAC,CAAC;IACL,CAAC;IAED,qCAAW,GAAX;QACE,EAAE,CAAC,CAAC,EAAE,cAAc,KAAK,CAAC,CAAC,CAAC,CAAC;YAC3B,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;QAC/C,CAAC;IACH,CAAC;IAtEH;QAAC,gBAAS,CAAC;YACT,QAAQ,EAAE,gBAAgB;YAC1B,IAAI,EAAE;gBACJ,kBAAkB,EAAE,OAAO;gBAC3B,gBAAgB,EAAE,OAAO;gBACzB,eAAe,EAAE,OAAO;gBACxB,aAAa,EAAE,OAAO;gBACtB,cAAc,EAAE,OAAO;gBACvB,eAAe,EAAE,OAAO;gBACxB,gBAAgB,EAAE,OAAO;aAC1B;YACD,UAAU,EAAE;gBACV,cAAO,CAAC,MAAM,EAAE;oBACd,iBAAU,CAAC,YAAY,EAAE;wBACvB,cAAO,CAAC,cAAc,EAAE,gBAAS,CAAC;4BAChC,YAAK,CAAC,EAAC,OAAO,EAAE,CAAC,EAAC,CAAC;4BACnB,YAAK,CAAC,EAAC,OAAO,EAAE,GAAG,EAAC,CAAC;yBACtB,CAAC,CAAC;qBACJ,CAAC;oBACF,YAAK,CAAC,KAAK,EAAG,YAAK,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAE,CAAC;oBACrC,iBAAU,CAAC,UAAU,EAAE;wBACrB,cAAO,CAAC,cAAc,EAAE,gBAAS,CAAC;4BAChC,YAAK,CAAC,EAAC,OAAO,EAAE,GAAG,EAAC,CAAC;4BACrB,YAAK,CAAC,EAAC,OAAO,EAAE,GAAG,EAAC,CAAC;yBACtB,CAAC,CAAC;wBACH,cAAO,CAAC,cAAc,EAAE,gBAAS,CAAC;4BAChC,YAAK,CAAC,EAAC,OAAO,EAAE,GAAG,EAAC,CAAC;4BACrB,YAAK,CAAC,EAAC,OAAO,EAAE,CAAC,EAAC,CAAC;yBACpB,CAAC,CAAC;qBACJ,CAAC;iBACH,CAAC;aACH;YACD,aAAa,EAAE,wBAAiB,CAAC,IAAI;YACrC,QAAQ,EAAE,+HACwB;SACnC,CAAC;;uBAAA;IAoCF,sBAAC;AAAD,CAAC,AAnCD,IAmCC;AAnCY,uBAAe,kBAmC3B,CAAA","sourcesContent":["import {\r\n  Component,\r\n  ViewEncapsulation,\r\n  OnDestroy,\r\n  trigger,\r\n  state,\r\n  style,\r\n  keyframes,\r\n  animate,\r\n  transition\r\n} from '@angular/core';\r\n\r\nimport { DialogRef } from '../../index';\r\nimport { BSModalContext } from './modal-context';\r\n\r\nlet dialogRefCount = 0;\r\n\r\n/**\r\n * Represents the modal backdrop.\r\n */\r\n@Component({\r\n  selector: 'modal-backdrop',\r\n  host: {\r\n    '[style.position]': 'hs.ps',\r\n    '[style.height]': 'hs.sz',\r\n    '[style.width]': 'hs.sz',\r\n    '[style.top]': 'hs.pt',\r\n    '[style.left]': 'hs.pt',\r\n    '[style.right]': 'hs.pt',\r\n    '[style.bottom]': 'hs.pt'\r\n  },\r\n  animations: [\r\n    trigger('fade', [\r\n      transition('void => in', [\r\n        animate('150ms linear', keyframes([\r\n          style({opacity: 0}),\r\n          style({opacity: 0.5})\r\n        ]))\r\n      ]),\r\n      state('out',  style({ opacity: 0 } )),\r\n      transition('* => out', [\r\n        animate('150ms linear', keyframes([\r\n          style({opacity: 0.5}),\r\n          style({opacity: 0.5})\r\n        ])),\r\n        animate('150ms linear', keyframes([\r\n          style({opacity: 0.5}),\r\n          style({opacity: 0}),\r\n        ]))\r\n      ])\r\n    ])\r\n  ],\r\n  encapsulation: ViewEncapsulation.None,\r\n  template: `<div [style.position]=\"hs.ps\" class=\"modal-backdrop in\" [@fade]=\"fadeState\"></div>\r\n<modal-container></modal-container>`\r\n})\r\nexport class BSModalBackdrop implements OnDestroy {\r\n  fadeState: 'in' | 'out' = 'in';\r\n\r\n  private hs = {ps: null, sz: null, pt: null};\r\n\r\n  constructor(dialog: DialogRef<BSModalContext>) {\r\n    dialogRefCount++;\r\n    document.body.classList.add('modal-open');\r\n\r\n    if (dialog.inElement) {\r\n      this.hs.ps = 'absolute';\r\n      this.hs.sz = '100%';\r\n      this.hs.pt = '0';\r\n    }\r\n\r\n    dialog.onDestroy.subscribe(() => this.fadeState = 'out');\r\n  }\r\n\r\n  /**\r\n   * Temp workaround for animation where destruction of the top level component does not\r\n   * trigger child animations. Solution should be found either in animation module or in design\r\n   * of the modal component tree.\r\n   * @returns {Promise<void>}\r\n   */\r\n  canDestroy(): Promise<void> {\r\n    return new Promise<void>(resolve => {\r\n      setTimeout(() => resolve(), 310);\r\n    });\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    if (--dialogRefCount === 0) {\r\n      document.body.classList.remove('modal-open');\r\n    }\r\n  }\r\n}\r\n"]}